# -*- coding: utf-8 -*-
"""Yet another copy of Untitled7.ipynb

Automatically generated by Colab.

Original file is located at
    https://colab.research.google.com/drive/14Jmu9Aygxe4lvy4LhCyUSUJViljU25FW

## **Sales** **Data** **Analysis** **of** **walmart** **dataset**
"""

import pandas as pd
import numpy as np
import matplotlib.pyplot as plt
from IPython.display import display
import seaborn as sns
from datetime import datetime
import warnings
warnings.filterwarnings('ignore')

df = pd.read_csv('/content/Walmart.csv')

df.head()

df.info()

(df.shape)

df.describe()

print("Duplicates:", df.duplicated().sum())

print("Missing values:\n", df.isnull().sum())

"""# ***Data*** ***Preprocessing***"""

#Convert Date column:
df['Date'] = pd.to_datetime(df['Date'], dayfirst=True, errors='raise')

print(df['Date'].head())

df['Store'] = df['Store'].astype('int')
df['Weekly_Sales'] = pd.to_numeric(df['Weekly_Sales'], errors='coerce')
df['Holiday_Flag'] = df['Holiday_Flag'].astype('bool')

print(df.dtypes)

print(df['Date'].min(),'to',df['Date'].max())

df = df.dropna()

df =df[df['Weekly_Sales']> 0]

df.head()

df.tail()

"""# ***Data Exploration***"""

Store_sales = df.groupby('Store')['Weekly_Sales'].agg(['mean','sum']).round(2)

print(Store_sales.sort_values('mean',ascending=False).head())

holiday_sales = df.groupby('Holiday_Flag')['Weekly_Sales'].mean()

print(holiday_sales)

print("Holiday vs  Non-Holiday avg sales:",holiday_sales.round(2))

"""# ***Visualizations***"""

plt.style.use('seaborn-v0_8')
fig,axes = plt.subplots(2,2, figsize=(15,12))

store_sales = df.groupby('Store')['Weekly_Sales']. agg(['mean',  'sum']). round(2)

#Sales trends over time
df.groupby('Date')['Weekly_Sales'].sum().plot(ax=axes[0,0], title='SALES TREND TOTAL')
axes[0,0].set_ylabel('WEEKLY SALES TOTAL')

#monthly
df['Month'] =df['Date'].dt.month
monthly_Sales = df.groupby('Month')['Weekly_Sales'].mean()
monthly_Sales.plot(ax=axes[0,1],title = 'avg of sales per month')
axes[0,1].set_xticklabels(['jan','feb','mar','apr','may','jun','jul','aug','sep','oct','nov','dec'])

top_stores = store_sales.head(10)
top_stores['mean'].plot(kind = 'bar',ax=axes [1,0],title= 'Top 10 stores avg sales')

sns.boxplot(data=df ,x='Holiday_Flag', y='Weekly_Sales',ax=axes[1,1])
axes[1,1].set_title ('sales Distribution: Holiday vs Non-Holiday')

plt.tight_layout()
plt.show()

display(fig)

"""# ***correlation heatmap***"""

numeric_cols = ['Weekly_Sales', 'Temperature', 'Fuel_Price', 'CPI', 'Unemployment']
corr = df[numeric_cols].corr()

plt.figure(figsize=(10,8))
sns.heatmap(corr, annot=True, cmap='RdYlBu_r', center=0, linewidths=1)
plt.title('correlations of Walmart Sales ')

"""# ***Scatter plot for holiday and Temperature impact***"""

sns.scatterplot(data= df, x='Temperature',y='Weekly_Sales',hue ='Holiday_Flag')
plt.title('Sales vs Temperature (Holiday Highlighted)')

"""##**Summarize** **findings** **and** **recommend** **strategies** **to** **improve** **sales** **forecasting** **and** **inventory** **management**.


**For inventory management:**

1)*Keep extra stock 20% more for top stores and holidays to avoid shortages.*


2)*Check weekly order based on last week's sales plus holiday flag for safety.*

â€‹
**For sales forecasting**

1)*Group weekly sales by date like in the script to get total trends, then use simple ARIMA for ups/downs and patterns or Prophet tool for easy handling of holidays and months. Add holiday as a yes/no switch to make predictions 10-20% better during busy times.*

"""